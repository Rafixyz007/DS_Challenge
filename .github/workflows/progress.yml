
name: Update Progress Badge

on:
  workflow_dispatch:        # allows manual run from Actions tab
  schedule:
    - cron: '0 0 * * *'    # runs daily at midnight UTC (optional)

jobs:
  update-progress:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.x

      - name: Update Progress Badge
        run: |
          import json

          # Load progress
          with open("progress.json") as f:
              data = json.load(f)

          total = data["total_days"]
          completed = data["completed_days"]
          percent = int((completed / total) * 100)

          # Generate SVG badge
          svg = f'''<svg xmlns="http://www.w3.org/2000/svg" width="120" height="20">
            <rect width="120" height="20" fill="#555"/>
            <rect x="60" width="60" height="20" fill="#4c1"/>
            <text x="60" y="14" fill="#fff" font-family="Verdana" font-size="11" text-anchor="middle">{percent}%</text>
          </svg>'''

          with open("progress.svg", "w") as f:
              f.write(svg)

      - name: Commit and Push
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "actions@github.com"
          git add progress.svg
          git commit -m "Update progress badge"
          git push
